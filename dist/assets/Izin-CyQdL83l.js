import{c as u,u as N,r as c,j as e,M as D,X as w,n as m,o as k,s as I,p as S}from"./index-BWiC8cDx.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=u("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=u("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=u("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function T(){const{user:t}=N(),[p,o]=c.useState([]),[j,x]=c.useState(!1),[a,r]=c.useState({startDate:"",endDate:"",leaveType:"annual",message:""}),[v,y]=c.useState({});c.useEffect(()=>{const s=()=>{const i=m();t.role==="manager"?o(i):o(i.filter(l=>l.userId===t.id));const d=k().reduce((l,g)=>(l[g.id]=g,l),{});y(d)};s();const n=setInterval(s,3e4);return()=>clearInterval(n)},[t]);const h=(s,n,i)=>{const d=m().map(l=>l.id===s?{...l,status:n?"approved":"rejected",response:n?"Disetujui":"Ditolak",respondedAt:new Date().toISOString()}:l);I(d),o(t.role==="manager"?d:d.filter(l=>l.userId===t.id))},b=s=>{if(s.preventDefault(),a.startDate&&a.endDate&&a.message){S(t.id,a.startDate,a.endDate,a.leaveType,a.message),x(!1),r({startDate:"",endDate:"",leaveType:"annual",message:""});const n=m();o(n.filter(i=>i.userId===t.id))}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Izin & Otorisasi"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[t.role==="karyawan"&&e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{children:"Ajukan Izin"})]}),e.jsx(D,{className:"w-6 h-6 text-blue-600"})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:t.role==="manager"?"Permintaan Otorisasi":"Riwayat Permintaan"}),e.jsx("div",{className:"space-y-4",children:p.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Tidak ada permintaan otorisasi"}):p.map(s=>{var n;return e.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"font-medium",children:s.type==="edit_checklist"?"Edit Checklist":s.type==="leave_request"?"Pengajuan Izin":"Permintaan Lain"}),t.role==="manager"&&e.jsxs("span",{className:"text-sm text-gray-500",children:["oleh ",((n=v[s.userId])==null?void 0:n.name)||"Unknown"]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.createdAt).toLocaleString("id-ID")})]}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${s.status==="pending"?"bg-yellow-100 text-yellow-800":s.status==="approved"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status==="pending"?"Menunggu":s.status==="approved"?"Disetujui":"Ditolak"})]}),e.jsx("p",{className:"text-gray-600",children:s.message}),s.type==="leave_request"&&s.startDate&&s.endDate&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(C,{className:"w-4 h-4"}),e.jsxs("span",{children:[new Date(s.startDate).toLocaleDateString("id-ID")," -"," ",new Date(s.endDate).toLocaleDateString("id-ID")]})]}),s.response&&e.jsxs("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium",children:"Respon:"}),e.jsx("p",{className:"text-gray-600",children:s.response})]}),t.role==="manager"&&s.status==="pending"&&e.jsxs("div",{className:"flex space-x-2 mt-2",children:[e.jsxs("button",{onClick:()=>h(s.id,!0),className:"flex items-center space-x-1 px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"Setuju"})]}),e.jsxs("button",{onClick:()=>h(s.id,!1),className:"flex items-center space-x-1 px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:"Tolak"})]})]}),s.respondedAt&&e.jsxs("p",{className:"text-sm text-gray-500",children:["Direspon pada: ",new Date(s.respondedAt).toLocaleString("id-ID")]})]},s.id)})})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Pengajuan Izin"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Jenis Izin"}),e.jsxs("select",{value:a.leaveType,onChange:s=>r({...a,leaveType:s.target.value}),className:"w-full p-2 border rounded-lg",required:!0,children:[e.jsx("option",{value:"annual",children:"Cuti Tahunan"}),e.jsx("option",{value:"sick",children:"Sakit"}),e.jsx("option",{value:"other",children:"Lainnya"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tanggal Mulai"}),e.jsx("input",{type:"date",value:a.startDate,onChange:s=>r({...a,startDate:s.target.value}),className:"w-full p-2 border rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tanggal Selesai"}),e.jsx("input",{type:"date",value:a.endDate,onChange:s=>r({...a,endDate:s.target.value}),className:"w-full p-2 border rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Keterangan"}),e.jsx("textarea",{value:a.message,onChange:s=>r({...a,message:s.target.value}),className:"w-full p-2 border rounded-lg",rows:4,placeholder:"Jelaskan alasan pengajuan izin...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Kirim"})]})]})]})})]})}export{T as default};
